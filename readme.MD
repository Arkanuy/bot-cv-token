# ğŸ¤– Discord Token Refresher Bot

A high-performance, modular Discord bot for refreshing account tokens using API server with concurrent processing and real-time progress tracking.

## âœ¨ Features

- **âš¡ Slash Command Interface**: `/generatetoken` with intuitive file upload
- **ğŸš€ Concurrent Processing**: Multi-threaded execution (configurable up to 100+ threads)
- **ğŸ“Š Real-Time Progress Tracking**: Auto-updating embeds every 2 seconds
- **ğŸ”„ Smart Proxy Management**: Automatic random proxy selection per account
- **ğŸ’» Platform Support**: Windows, macOS, and Android
- **ğŸ”’ Private Results**: Files sent via DM for privacy
- **ğŸ“ Comprehensive Logging**: Detailed console output for monitoring
- **ğŸ›¡ï¸ Error Handling**: Robust retry logic and fallback mechanisms
- **ğŸ¯ Auto-Deploy Commands**: Slash commands register automatically on startup

## ğŸ“‹ Prerequisites

Before starting, make sure you have:

- âœ… A Discord account
- âœ… A Discord bot token ([How to get one](https://discord.com/developers/applications))
- âœ… Node.js installed (see installation guide below)
- âœ… Working proxies
- âœ… Access to API server

## ğŸ”§ Node.js Installation Guide

### ğŸªŸ Windows

1. **Download Node.js**
   - Visit [nodejs.org](https://nodejs.org/)
   - Download the **LTS version** (recommended)
   - Run the installer (.msi file)

2. **Installation Steps**
   - Click "Next" through the installation wizard
   - Accept the license agreement
   - Choose installation path (default is fine)
   - âœ… Check "Automatically install necessary tools"
   - Click "Install" and wait for completion

3. **Verify Installation**
   ```bash
   node --version
   npm --version
   ```
   You should see version numbers like `v20.11.0` and `10.2.4`

### ğŸ macOS

1. **Using Official Installer**
   - Visit [nodejs.org](https://nodejs.org/)
   - Download the **LTS version** (.pkg file)
   - Open the package and follow installation steps
   - Enter your password when prompted

2. **Using Homebrew** (Alternative)
   ```bash
   brew install node
   ```

3. **Verify Installation**
   ```bash
   node --version
   npm --version
   ```

### ğŸ§ Linux (Ubuntu/Debian)

1. **Install Node.js**
   ```bash
   curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
   sudo apt-get install -y nodejs
   ```

2. **Verify Installation**
   ```bash
   node --version
   npm --version
   ```

### ğŸ” Common Node.js Installation Issues

- **"node is not recognized"**: Restart your terminal/command prompt
- **Permission errors on Linux/macOS**: Use `sudo` or fix npm permissions
- **Old version installed**: Uninstall old version first, then reinstall

## ğŸš€ Quick Start

### 1ï¸âƒ£ Installation

```bash
npm install
```

### 2ï¸âƒ£ Configuration

Edit `.env` file:
You need to rename file .env.example to .env first

```env
DISCORD_TOKEN=your_discord_bot_token_here
API_URL=https://arkanstore.site
MAX_THREADS=100
```

### 3ï¸âƒ£ Setup Proxies

Add your proxies to `proxy.txt` (one per line):

```
host:port:username:password
```

Example:
```
renncloud.xyz:10005:user123:pass456
renncloud.xyz:10006:user123:pass456
proxy.example.com:8080:myuser:mypass
```

### 4ï¸âƒ£ Run the Bot

```bash
npm start
```

ğŸ‰ Slash commands will be deployed automatically when the bot starts!

## ğŸ“– Usage

### Command: `/generatetoken`

**Parameters:**
- ğŸ“ `file` (required): Upload a .txt file containing emails (one per line)
- ğŸ–¥ï¸ `platform` (optional): Choose Windows, macOS, or Android (defaults to Windows)

**Example email file format:**
```
user1@gmail.com
user2@gmail.com
user3@gmail.com
```

### ğŸ“ˆ Real-Time Progress Display

The bot shows live progress with automatic updates:

```
ğŸ”„ Processing Accounts
Progress: 45/190 (23.7%)
Status:
âœ… Success: 38
âŒ Failed: 7
ğŸš« Not Found: 0
ğŸ”„ Retrying: 0
[â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘]
Time:
â±ï¸ Elapsed: 15.3s
ğŸ”® ETA: 48s
âš¡ Avg: 0.34s/account
```

### ğŸ“¬ Results Delivery

- **ğŸ“Š Progress embed** updates in the channel where command was executed
- **ğŸ“ Result files** sent privately via Direct Message:
  - `successful_tokens.txt` - Format: `email:token`
  - `failed_emails.txt` - Format: `email:error_reason`

## âš¡ Performance

**Example with 190 accounts:**
- **ğŸš€ MAX_THREADS=100**: ~40 seconds total
- **âš¡ MAX_THREADS=50**: ~80 seconds total
- **ğŸ¢ MAX_THREADS=1**: ~57 minutes total

**ğŸ’¡ Concurrent processing significantly reduces processing time!**

## ğŸ“ Project Structure

```
discord-bot/
â”œâ”€â”€ commands/
â”‚   â””â”€â”€ generatetoken.js          # ğŸ¯ Main command handler
â”œâ”€â”€ services/
â”‚   â””â”€â”€ tokenProcessor.js         # âš™ï¸ Concurrent processing logic
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ apiClient.js              # ğŸŒ API communication
â”‚   â”œâ”€â”€ embedUtils.js             # ğŸ¨ Discord embed formatting
â”‚   â”œâ”€â”€ proxyUtils.js             # ğŸ”„ Proxy management
â”‚   â””â”€â”€ backgroundUpdater.js      # ğŸ“Š Real-time embed updates
â”œâ”€â”€ index.js                      # ğŸš€ Bot entry point
â”œâ”€â”€ deploy-commands.js            # ğŸ¯ Command registration (auto)
â”œâ”€â”€ package.json                  # ğŸ“¦ Dependencies
â”œâ”€â”€ .env                          # âš™ï¸ Configuration
â”œâ”€â”€ proxy.txt                     # ğŸŒ Proxy list
â””â”€â”€ README.md                     # ğŸ“– Documentation
```

## âš™ï¸ Configuration Details

### ğŸ” Environment Variables

| Variable | Description | Default | Example |
|----------|-------------|---------|---------|
| `DISCORD_TOKEN` | Your Discord bot token | Required | `MTk5O...` |
| `API_URL` | Your API server URL | Required | `https://arkanstore.site` |
| `MAX_THREADS` | Maximum concurrent requests | 100 | `50`, `100`, `200` |

### ğŸŒ Proxy Format

Supports both authenticated and non-authenticated proxies:

- **ğŸ”‘ With authentication**: `host:port:username:password`
- **ğŸ”“ Without authentication**: `host:port`

## ğŸ–¥ï¸ Console Logging

The bot provides detailed console output for monitoring:

```
=== Token Generation Request ===
User: username#1234 (123456789)
Guild: My Server (987654321)
ğŸ“ File: accounts.txt (5024 bytes)
ğŸ–¥ï¸ Platform: Windows
ğŸ“§ Found 190 emails in file

ğŸ”„ Starting token processing...
ğŸ“§ Total accounts: 190
ğŸ–¥ï¸ Platform: Windows
ğŸ§µ Max concurrent threads: 100

ğŸ”„ Processing batch 1 (100 accounts)
[1/190] Processing: user1@gmail.com
ğŸŒ Using proxy: renncloud.xyz:10005
ğŸš€ API Request [1/100]: user1@gmail.com
ğŸ“¡ API Response for user1@gmail.com: Success
âœ… Success! Token generated for user1@gmail.com (2.3s)
ğŸ“‰ Active requests: 99/100

ğŸ“Š Progress: 45/190 (23.7%) | Success: 38 | Failed: 7 | Not Found: 0

=== Final Results ===
âœ… Success: 165
âŒ Failed: 20
ğŸš« Not Found: 5
â±ï¸ Total Time: 42.8s
ğŸ“„ Generated successful_tokens.txt (98450 bytes)
ğŸ“„ Generated failed_emails.txt (1250 bytes)
ğŸ“© Sending 2 files to user DM...
âœ… Files sent to username#1234 via DM
```

## ğŸ›¡ï¸ Error Handling

The bot handles various error scenarios:

- **âš ï¸ Maximum threads reached**: Queues requests appropriately
- **ğŸ”´ Proxy unavailable**: Skips account and logs error
- **ğŸ”„ API timeout**: Retries with exponential backoff
- **ğŸš« DM disabled**: Falls back to ephemeral reply
- **â° Expired embed**: Creates new message automatically
- **ğŸŒ Network errors**: Logs and continues processing

## ğŸ¯ Features Breakdown

### 1ï¸âƒ£ Concurrent Processing
- âš¡ Processes multiple accounts simultaneously
- ğŸ›ï¸ Configurable thread limit via `MAX_THREADS`
- ğŸ“¦ Batch processing for optimal performance

### 2ï¸âƒ£ Real-Time Updates
- â±ï¸ Background timer updates embed every 2 seconds
- ğŸ”€ Independent from main processing thread
- ğŸ“Š Shows live progress, ETA, and statistics

### 3ï¸âƒ£ Smart Proxy Management
- ğŸ² Random proxy selection for each account
- ğŸ“¥ Automatic proxy list loading on startup
- âœ… Format validation and error handling

### 4ï¸âƒ£ Privacy-First Design
- ğŸ‘€ Progress visible to all in channel
- ğŸ”’ Results sent privately via DM
- ğŸ” Fallback to ephemeral if DM fails

### 5ï¸âƒ£ Comprehensive Logging
- ğŸ“ Request tracking with timestamps
- ğŸ“¡ API response monitoring
- ğŸ“ˆ Thread utilization metrics
- ğŸ› Error tracking with context

## ğŸ”§ Troubleshooting

### ğŸ¤– Bot not responding
- âœ… Check `DISCORD_TOKEN` is correct
- âœ… Ensure bot has proper permissions in Discord
- âœ… Verify bot is online in Discord developer portal

### âš¡ Slash commands not appearing
- â³ Wait 1-2 minutes after bot starts
- ğŸ”„ Kick and re-invite bot to server
- ğŸ“ Check console for command deployment errors

### ğŸŒ "No proxy available" errors
- âœ… Verify `proxy.txt` exists and contains proxies
- âœ… Check proxy format: `host:port:username:password`
- âœ… Ensure proxies are active and working

### â° API timeout errors
- âœ… Check `API_URL` is correct and accessible
- âœ… Verify API server is running
- ğŸ”» Reduce `MAX_THREADS` if server is overloaded

### ğŸ“¬ DM delivery failed
- âœ… User must enable DMs from server members
- ğŸ”„ Bot will send files as ephemeral reply instead
- âš™ï¸ Check user's privacy settings

## ğŸ“¦ Requirements

- **ğŸŸ¢ Node.js**: v16.9.0 or higher
- **ğŸ¤– Discord.js**: v14.14.1 or higher
- **ğŸŒ API Server**: Compatible with the provided Flask API
- **ğŸ”„ Proxy List**: At least one working proxy in `proxy.txt`

## ğŸ“„ License

This project is provided as-is for educational and authorized use only.

## ğŸ’¬ Support

For issues or questions:
1. ğŸ“ Check console logs for detailed error messages
2. âš™ï¸ Verify all configuration in `.env`
3. ğŸŒ Ensure proxy list is valid and accessible
4. ğŸ§ª Test API endpoint independently

---

**Made with â¤ï¸ for efficient token management**

ğŸŒŸ Don't forget to star this project if you find it useful!
